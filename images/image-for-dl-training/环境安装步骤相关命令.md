# 环境安装步骤

## 1 ssh工具安装

选择一个ssh工具，可以是下面的某一种：

1）XManager https://pan.baidu.com/s/1KCqrrDXPq0rOgpNMIriX9A  提取码：nnn8，或者http://u.163.com/swnf7p4t  提取码: PAYnm3fY
2）putty
3）如果本身是linux或mac，可以直接使用ssh命令

## 2 远程连接到各自对应的linux环境

在远程连接工具中执行如下命令, 请填写自己的序号
```
ssh leinao@36.7.159.236 -p $(( 10100 + 序号))
```

**提示:**
*sudo 命令执行时提示输入密码时,请输入登录机器的密码,默认### *

## 3 英伟达驱动安装

1） 安装驱动
```
cd /home/leinao
sudo ./NVIDIA-Linux-x86_64-390.59.run -s
```
2） 验证是否安装成功,执行如下命令
```
nvidia-smi
```

## 4 Docker安装
1) 安装命令
```
sudo apt-get update
sudo apt-get -y install apt-transport-https  ca-certificates  curl  software-properties-common
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo apt-key fingerprint 0EBFCD88
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
sudo apt-get update
sudo apt-get -y install docker-ce
```
2) 验证是否安装
```
sudo docker run hello-world
```

## 5 nvidia-docker安装
1) 安装命令
```
curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey |  sudo apt-key add -
distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list |   sudo tee /etc/apt/sources.list.d/nvidia-docker.list
sudo apt-get update
sudo apt-get install -y nvidia-docker2
sudo pkill -SIGHUP dockerd
```
2) 验证命令
```
sudo docker run --runtime=nvidia --rm nvidia/cuda:9.0-base nvidia-smi
```

## 6 载入镜像
执行如下命令
```
sudo docker load -i leinaotraining.tar
```

## 7 创建容器
执行如下命令
```
sudo docker run --runtime=nvidia -ti --ipc=host   -v /home/leinao/result:/result -p 10022:22 --name leinao leinao/tensorflow-mxnet-py36-cu90 bash
```
命令执行成功后,命令行交互已经处于容器内,可以在容器内进行需要的编程操作

## 8 可选步骤
在上一步的容器内
```
apt update && apt install -y openssh-server
service ssh start
adduser leinao # 设置密码
```
这样之后可以通过 ssh leinao@36.7.159.236 -p $(( 10200 + 序号)) 直接登录容器

重新启动容器
```
docker start leinao
```
重新进入容器：
```
docker exec -ti leinao bash
```